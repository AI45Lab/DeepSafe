task_name: demo_mm_safetybench_2stage
output_dir: results/demo_mm_safetybench_2stage

dataset:
  type: MMSafetyBenchDataset
  # Path should be MM-SafetyBench root directory containing `data/`
  # path: /mnt/shared-storage-user/zhangbo1/datasets/MM-SafetyBench-sample100
  path: /mnt/shared-storage-user/zhangbo1/datasets/MM-SafetyBench
  include_splits:
    - SD_TYPO

# Target model (GEN stage). EVAL stage can override to NoOpModel in run_mm_safetybench_eval.sh
model:
  type: APIModel
  model_name: /mnt/shared-storage-user/ai4good2-share/models/Qwen/Qwen2.5-VL-7B-Instruct
  api_base: http://localhost:21115/v1
  api_key: EMPTY
  mode: chat
  temperature: 0.0
  max_tokens: 512
  repetition_penalty: 1.0
  tensor_parallel_size: 1
  gpu_memory_utilization: 0.8
  concurrency: 4

evaluator:
  type: MMSafetyBenchEvaluator
  batch_size: 2
  template_name: mm_safetybench_general
  use_category_specific_prompts: true
  prediction_field: prediction
  use_precomputed_predictions: false
  require_precomputed_predictions: false
  judge_model_cfg:
    # Judge fixed to gpt-4 (APIModel). Key comes from env (OPENAI_API_KEY).
    type: APIModel
    model_name: gpt-4
    api_base: http://35.220.164.252:3888/v1
    api_key: ENV
    mode: chat
    concurrency: 8
    temperature: 0.0
    max_tokens: 256

metrics:
  - type: MMSafetyBenchMetric

summarizer:
  type: StandardSummarizer

runner:
  type: LocalRunner
  output_dir: results/demo_mm_safetybench_2stage


